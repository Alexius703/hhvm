error: Typing[4110] Invalid return type

Expected `A`

10 | function foo(bool  $p, A $x, B $y): »A« {
11 |   if($p){
12 |     $z = $x;

File "union_subtyping.php", line 10, character 37 - line 10, character 37:

But got `B`

10 | function foo(bool  $p, A $x, »B« $y): A {
11 |   if($p){
12 |     $z = $x;

File "union_subtyping.php", line 10, character 30 - line 10, character 30:

Flow:
{
  "Rflow":[
    {
      "Rflow":[
        {
          "Rflow":[
            {
              "Rflow":[
                {
                  "Rflow":[
                    {
                      "Rhint":[{"filename":"union_subtyping.php","line":10,"char_start":30,"char_end":30}]
                    },
                    {
                      "Rwitness":[{"filename":"union_subtyping.php","line":10,"char_start":32,"char_end":33}]
                    }
                  ]
                },
                {
                  "Rwitness":[{"filename":"union_subtyping.php","line":14,"char_start":10,"char_end":11}]
                }
              ]
            },
            {
              "Rwitness":[{"filename":"union_subtyping.php","line":14,"char_start":5,"char_end":6}]
            }
          ]
        },
        {
          "Rprj_asymm_left":[
            "Prj_asymm_union",
            {
              "Rflow":[
                {
                  "Rflow":[
                    {
                      "Rwitness":[{"filename":"union_subtyping.php","line":11,"char_start":3,"char_end":49}]
                    },
                    {
                      "Rwitness":[{"filename":"union_subtyping.php","line":17,"char_start":10,"char_end":11}]
                    }
                  ]
                },
                {
                  "Rwitness":[{"filename":"union_subtyping.php","line":17,"char_start":3,"char_end":12}]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "Rhint":[{"filename":"union_subtyping.php","line":10,"char_start":37,"char_end":37}]
    }
  ]
}


File "", line 0, character 0 - line 0, character -1:

error: Typing[4110] Invalid return type

Expected `C`

 21 | function union_l((A | B) $ab): »C« {
 22 |   return $ab;
 23 | }

File "union_subtyping.php", line 21, character 32 - line 21, character 32:

But got `A`

 21 | function union_l((»A« | B) $ab): C {
 22 |   return $ab;
 23 | }

File "union_subtyping.php", line 21, character 19 - line 21, character 19:

Flow:
{
  "Rflow":[
    {
      "Rflow":[
        {
          "Rhint":[{"filename":"union_subtyping.php","line":21,"char_start":19,"char_end":19}]
        },
        {
          "Rprj_asymm_left":[
            "Prj_asymm_union",
            {
              "Rflow":[
                {
                  "Rflow":[
                    {
                      "Rflow":[
                        {
                          "Rhint":[{"filename":"union_subtyping.php","line":21,"char_start":18,"char_end":24}]
                        },
                        {
                          "Rwitness":[{"filename":"union_subtyping.php","line":21,"char_start":26,"char_end":28}]
                        }
                      ]
                    },
                    {
                      "Rwitness":[{"filename":"union_subtyping.php","line":22,"char_start":10,"char_end":12}]
                    }
                  ]
                },
                {
                  "Rwitness":[{"filename":"union_subtyping.php","line":22,"char_start":3,"char_end":13}]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "Rhint":[{"filename":"union_subtyping.php","line":21,"char_start":32,"char_end":32}]
    }
  ]
}


File "", line 0, character 0 - line 0, character -1:

error: Typing[4110] Invalid return type

Expected `C`

 21 | function union_l((A | B) $ab): »C« {
 22 |   return $ab;
 23 | }

File "union_subtyping.php", line 21, character 32 - line 21, character 32:

But got `B`

 21 | function union_l((A | »B«) $ab): C {
 22 |   return $ab;
 23 | }

File "union_subtyping.php", line 21, character 23 - line 21, character 23:

Flow:
{
  "Rflow":[
    {
      "Rflow":[
        {
          "Rhint":[{"filename":"union_subtyping.php","line":21,"char_start":23,"char_end":23}]
        },
        {
          "Rprj_asymm_left":[
            "Prj_asymm_union",
            {
              "Rflow":[
                {
                  "Rflow":[
                    {
                      "Rflow":[
                        {
                          "Rhint":[{"filename":"union_subtyping.php","line":21,"char_start":18,"char_end":24}]
                        },
                        {
                          "Rwitness":[{"filename":"union_subtyping.php","line":21,"char_start":26,"char_end":28}]
                        }
                      ]
                    },
                    {
                      "Rwitness":[{"filename":"union_subtyping.php","line":22,"char_start":10,"char_end":12}]
                    }
                  ]
                },
                {
                  "Rwitness":[{"filename":"union_subtyping.php","line":22,"char_start":3,"char_end":13}]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "Rhint":[{"filename":"union_subtyping.php","line":21,"char_start":32,"char_end":32}]
    }
  ]
}


File "", line 0, character 0 - line 0, character -1:

error: Typing[4110] Invalid return type

Expected `B`

 25 | function union_r(C $c): (A|»B«) {
 26 |   return $c;
 27 | }

File "union_subtyping.php", line 25, character 28 - line 25, character 28:

But got `C`

 25 | function union_r(»C« $c): (A|B) {
 26 |   return $c;
 27 | }

File "union_subtyping.php", line 25, character 18 - line 25, character 18:

Flow:
{
  "Rflow":[
    {
      "Rflow":[
        {
          "Rflow":[
            {
              "Rflow":[
                {
                  "Rhint":[{"filename":"union_subtyping.php","line":25,"char_start":18,"char_end":18}]
                },
                {
                  "Rwitness":[{"filename":"union_subtyping.php","line":25,"char_start":20,"char_end":21}]
                }
              ]
            },
            {
              "Rwitness":[{"filename":"union_subtyping.php","line":26,"char_start":10,"char_end":11}]
            }
          ]
        },
        {
          "Rwitness":[{"filename":"union_subtyping.php","line":26,"char_start":3,"char_end":12}]
        }
      ]
    },
    {
      "Rflow":[
        {
          "Rprj_asymm_right":[
            "Prj_asymm_union",
            {
              "Rhint":[{"filename":"union_subtyping.php","line":25,"char_start":25,"char_end":29}]
            }
          ]
        },
        {
          "Rhint":[{"filename":"union_subtyping.php","line":25,"char_start":28,"char_end":28}]
        }
      ]
    }
  ]
}


File "", line 0, character 0 - line 0, character -1:

4 errors found.
